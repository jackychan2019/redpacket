{php include wl_template('common/header');}
<ul class="nav nav-tabs" id="myTab">
	<li class="active"><a href="#tab_basic">基本设置</a></li>
	<li><a href="#tab_cube">魔方设置</a></li>
	<li><a href="#tab_community">社群设置</a></li>
	<li><a href="#tab_share">列表分享</a></li>
</ul>
<div class="app-content">
	<div class="app-form">
		<form action="" method="post" class="form-horizontal" id="setting-form">
			<div class="panel panel-default">
				<div class="panel-heading">模块设置</div>
				<div class="panel-body">
					<div class="tab-content">
						<div class="tab-pane active" id="tab_basic">
							<div class="form-group">
								<label class="col-sm-2 control-label">是否开启分销(默认)</label>
								<div class="col-sm-9">
									<label class="radio-inline">
										<input type="radio" value="0" name="base[distribution]" {if $base['distribution'] == 0 || empty($base['distribution'])} checked {/if} /> 关闭
									</label>
									<label class="radio-inline">
										<input type="radio" value="1" name="base[distribution]" {if $base['distribution'] == 1} checked {/if} /> 开启
									</label>
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-2 control-label">是否开启独立结算(默认)</label>
								<div class="col-sm-9">
									<label class="radio-inline">
										<input type="radio" value="0" name="base[settlement]" {if $base['settlement']==0||!$base['settlement']} checked {/if}> 关闭
									</label>
									<label class="radio-inline">
										<input type="radio" value="1" name="base[settlement]" {if $base['settlement']==1} checked {/if}> 开启
									</label>
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-2 control-label">分类层级</label>
								<div class="col-sm-9">
									<label class="radio-inline">
										<input type="radio" value="0" name="base[catelevel]" {if $base['catelevel'] == 0 || empty($base['catelevel'])} checked {/if} /> 一级
									</label>
									<label class="radio-inline">
										<input type="radio" value="1" name="base[catelevel]" {if $base['catelevel'] == 1} checked {/if} /> 二级
									</label>
								</div>
							</div>
                            <div class="form-group">
                                <label class="col-sm-2 control-label">搜索框</label>
                                <div class="col-sm-9">
                                    <label class="radio-inline">
                                        <input type="radio" value="0" name="base[search]" {if $base['search']==0||!$base['search']} checked {/if}>启用
                                    </label>
                                    <label class="radio-inline">
                                        <input type="radio" value="1" name="base[search]" {if $base['search']==1} checked {/if}>禁用
                                    </label>
                                </div>
                            </div>
							<div class="form-group search_float" {if $base['search'] == 1}style="display:none;"{/if}>
								<label class="col-sm-2 control-label">搜索框是否浮动</label>
								<div class="col-sm-9">
									<label class="radio-inline">
										<input type="radio" value="0" name="base[search_float]" {if $base['search_float']==0||!$base['search_float']} checked {/if}> 浮动
									</label>
									<label class="radio-inline">
										<input type="radio" value="1" name="base[search_float]" {if $base['search_float']==1} checked {/if}> 固定
									</label>
									<span class="help-block">设置为浮动时，会覆盖一部分内容。设为固定则不会覆盖内容</span>
								</div>
							</div>
							<div class="form-group search_bgColor" {if $base['search'] == 1 || $base['search_float'] != 1}style="display:none;"{/if}>
								<label class="col-sm-2 control-label">搜索框背景颜色</label>
								<div class="col-sm-9">
									<div class="input-group">
										<input type="color" value="{if $base['search_bgColor']}{$base['search_bgColor']}{else}#000000{/if}" name="base[search_bgColor]" class="form-control" style="width: 120px;padding: 0px 3px;">
									</div>
									<span class="help-block">当搜索框设为固定是请设置背景颜色，否则默认为黑色背景</span>
								</div>
							</div>
                            <div class="form-group">
                                <label class="col-sm-2 control-label">无图分类是否显示</label>
                                <div class="col-sm-9">
                                    <label class="radio-inline">
                                        <input type="radio" value="0" name="base[display]" {if $base['display'] != 1} checked {/if} /> 显示
                                    </label>
                                    <label class="radio-inline">
                                        <input type="radio" value="1" name="base[display]" {if $base['display'] == 1} checked {/if} /> 隐藏
                                    </label>
                                    <span class="help-block">设置无图标分类是否在团购中显示</span>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-2 control-label">商品列表显示折扣</label>
                                <div class="col-sm-9">
                                    <label class="radio-inline">
                                        <input type="radio" value="0" name="base[discountstatus]" {if $base['discountstatus'] != 1} checked {/if} /> 显示
                                    </label>
                                    <label class="radio-inline">
                                        <input type="radio" value="1" name="base[discountstatus]" {if $base['discountstatus'] == 1} checked {/if} /> 隐藏
                                    </label>
                                    <span class="help-block">设置是否在团购商品列表中显示系统自动生成的折扣标签</span>
                                </div>
                            </div>
							<div class="form-group">
								<label class="col-sm-2 control-label">商品详情显示超值套餐</label>
								<div class="col-sm-9">
									<label class="radio-inline">
										<input type="radio" value="0" onclick="$('#relevantnum').show();" name="base[showrelevant]" {if $base['showrelevant'] != 1} checked {/if} /> 显示
									</label>
									<label class="radio-inline">
										<input type="radio" value="1" onclick="$('#relevantnum').hide();" name="base[showrelevant]" {if $base['showrelevant'] == 1} checked {/if} /> 关闭
									</label>
									<span class="help-block">设置是否在团购商品详情中显示相同商户的其他商品</span>
								</div>
							</div>
							<div class="form-group" id="relevantnum" {if $base['showrelevant'] == 1 } style="display: none" {/if} >
								<label class="col-sm-2 control-label">超值套餐商品加载数量</label>
								<div class="col-sm-9">
									<div class="input-group">
										<input type="text" name="base[relevantnum]" class="form-control" value="{$base['relevantnum']}" />
										<span class="input-group-addon">个</span>
									</div>
									<span class="help-block">设置在团购商品详情中显示相同商户的其他商品个数，最少2个,默认10个</span>
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-2 control-label">未支付订单取消时间</label>
								<div class="col-sm-9">
									<div class="input-group">
										<input type="text" name="base[cancle_time]" class="form-control" value="{$base['cancle_time']}" />
										<span class="input-group-addon">分钟</span>
									</div>
									<span class="help-block">自抢到后计时，填0或则不填默认为3分钟，该时间内支付有效，过期且未支付则自动取消订单。</span>
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-2 control-label">消费截止通知</label>
								<div class="col-sm-9">
									<div class="input-group">
										<input type="text" name="base[cutoff_time]" class="form-control" value="{$base['cutoff_time']}" />
										<span class="input-group-addon">天</span>
									</div>
									<span class="help-block">订单消费截止时间到来通知，默认7天</span>
								</div>
							</div>
							<div class="form-group" id="rushgoods">
								<label class="col-sm-2 control-label">推荐抢购商品</label>
								<div class="col-sm-9">
									<select multiple="multiple" name="rushids[]" class="form-control select2 col-sm-7 col-xs-6" style="width: 100%;">
										{loop $rushgoods $rush}
										<option value="{$rush['id']}" {if in_array($rush['id'],$base['rushids'])} selected="selected" {/if}>{$rush['name']}</option>
										{/loop}
									</select>
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-2 control-label">团购列表标题</label>
								<div class="col-sm-9">
									<input type="text" name="base[listtitle]" class="form-control" value="{$base['listtitle']}"/>
									<span class="help-block">默认:团购列表</span>
								</div>
							</div>
							{if p('rush')}
							<div class="form-group">
								<label class="col-sm-2 control-label">列表抢购栏标题</label>
								<div class="col-sm-9">
									<input type="text" name="base[rushtitle]" class="form-control" value="{$base['rushtitle']}"/>
									<span class="help-block">默认:超值抢购</span>
								</div>
							</div>
							{/if}
							<div class="form-group form-inline">
								<label class="col-sm-2 control-label">商品列表标题栏</label>
								<div class="col-sm-10">
									<div class="input-group img-item">
										<div class="input-group-addon">
											<img {if $base['titleimg']} src="{php echo tomedia($base['titleimg'])}" {else} src="{URL_MODULE}plugin/wlcoupon/app/resource/images/2.png" {/if} style="height:20px;width:20px" />
										</div>
										<input type="text" class="form-control" name="base[titleimg]"  value="{$base['titleimg']}"/>
										<div class="input-group-btn">
											<button type="button" class="btn btn-default btn-select-pic">选择图片</button>
										</div>
									</div>
									<input type="text" class="form-control" placeholder="标题栏标题"  name="base[titlename]"  value="{$base['titlename']}"/>
									<input type="text" class="form-control" placeholder="标题栏描述"  name="base[titledis]"  value="{$base['titledis']}"/>
								</div>
							</div>
						</div>
						<div class="tab-pane" id="tab_cube">
							<style>
								h5{font-size: 14px;}
							</style>
							<div class="bs-callout bs-callout-danger" id="callout-glyphicons-empty-only">
								<h4>按照顺序,显示一张提即为图一，显示二张即为图二。</h4>
								<div class="bs-example bs-example-images" data-example-id="image-shapes">
									<div class="row">
										<div class="col-md-2">
											<img style="margin-top: 20px;"  class="img-thumbnail"  src="{URL_WEB_RESOURCE}image/cube/1.png" data-holder-rendered="true">
											<div class="caption">
												<h5>一张图效果</h5>
											</div>
										</div>
										<div class="col-md-2">
											<img style="margin-top: 20px;"  class="img-thumbnail"  src="{URL_WEB_RESOURCE}image/cube/2.png" data-holder-rendered="true">
											<div class="caption">
												<h5>两张图效果</h5>
											</div>
										</div>
										<div class="col-md-2">
											<img style="margin-top: 20px;"  class="img-thumbnail"  src="{URL_WEB_RESOURCE}image/cube/3.png" data-holder-rendered="true">
											<div class="caption">
												<h5>三张图效果</h5>
											</div>
										</div>
										<div class="col-md-2">
											<img style="margin-top: 20px;" class="img-thumbnail"  src="{URL_WEB_RESOURCE}image/cube/4.png" data-holder-rendered="true">
											<div class="caption">
												<h5>四张图效果</h5>
											</div>
										</div>
										<div class="col-md-2">
											<img style="margin-top: 20px;" class="img-thumbnail"  src="{URL_WEB_RESOURCE}image/cube/5.png" data-holder-rendered="true">
											<div class="caption">
												<h5>五张图效果</h5>
											</div>
										</div>
										<div class="col-md-2">
											<img style="margin-top: 20px;" class="img-thumbnail"  src="{URL_WEB_RESOURCE}image/cube/6.png" data-holder-rendered="true">
											<div class="caption">
												<h5>六张图效果</h5>
											</div>
										</div>
									</div>
								</div>
							</div>
							<div class="panel panel-default">
								<div class="panel-body table-responsive" style="padding: 0px;">
									<div class="panel-body table-responsive" style="padding:0px;">
										<table class="table table-hover">
											<tbody id="param-items-level">
											{loop $cubes $key $cube}
											<tr>
												<td style="width: 8%;text-align: center;">
													<a href="javascript:;" class="fa fa-move" title="拖动调整此显示顺序"><i class="fa fa-arrows"></i></a>&nbsp;
												</td>
												<td style="width: 40%;">
													<div class="input-group img-item">
														<div class="input-group-addon">
															<img src="{php echo tomedia($cube['thumb'])}" style="height:20px;width:20px" />
														</div>
														<input type="text" class="form-control" name="cubes_thumbs[]"  value="{$cube['thumb']}"/>
														<div class="input-group-btn">
															<button type="button" class="btn btn-default btn-select-pic">选择图片</button>
														</div>
													</div>
												</td>
												<td style="width: 40%;">
													<div class="input-group form-group" style="margin: 0;">
														<input name="cubes_links[]" id="advlink_{$key}" type="text" class="form-control param_value" value="{$cube['link']}" placeholder="跳转链接"/>
														<span data-input="#advlink_{$key}" data-toggle="selectUrl" class="input-group-addon btn btn-default">选择链接</span>
													</div>
												</td>
												<td style="width: 12%;text-align: center;">
													<input class="js-switch" type="checkbox" name="on[]"  value="{$key}" {if $cube['on'] == 1}checked{/if} />
												</td>
											</tr>
											{/loop}
											</tbody>
											<tbody>
											</tbody>
										</table>
									</div>
								</div>
							</div>
							<script type="text/javascript">
                                $(function(){
                                    require(['jquery.ui'],function($){
                                        $("#param-items-level").sortable({handle:'.fa-move'});
                                    });
                                    bindEvents();
                                });
                                function bindEvents() {
                                    require(['jquery', 'util'], function ($, util) {
                                        $('.btn-select-pic').unbind('click').click(function () {
                                            var imgitem = $(this).closest('.img-item');
                                            util.image('', function (data) {
                                                imgitem.find('img').attr('src', data['url']);
                                                imgitem.find('input').val(data['attachment']);
                                            });
                                        });
                                    });
                                }
							</script>
						</div>
						<div class="tab-pane" id="tab_community">
							<div class="form-group">
								<label class="col-sm-2 control-label">社群名称</label>
								<div class="col-sm-9">
									<input type="text" name="base[communname]" class="form-control" value="{$base['communname']}" />
									<span class="help-block">如不填写名称默认调用系统社群名称</span>
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-2 control-label">社群描述</label>
								<div class="col-sm-9">
									<input type="text" name="base[commundesc]" class="form-control" value="{$base['commundesc']}" />
									<span class="help-block">如不填写描述默认调用系统社群描述</span>
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-2 control-label">社群图标</label>
								<div class="col-sm-9">
									{php echo tpl_form_field_image('base[communimg]', $base['communimg']);}
									<span class="help-block">图片建议尺寸100X100,如不上传图标默认调用系统社群图标</span>
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-2 control-label">社群二维码</label>
								<div class="col-sm-9">
									{php echo tpl_form_field_image('base[communqrcode]', $base['communqrcode']);}
									<span class="help-block">图片建议尺寸300X300,如不上传二维码默认关闭社群功能</span>
								</div>
							</div>
						</div>
						<div class="tab-pane" id="tab_share">
							<div class="alert alert-info">
								<b>适用模板变量：[昵称] [时间] [系统名称]</b>
							</div>
							<div class="form-group">
								<label class="col-sm-2 control-label">分享标题</label>
								<div class="col-sm-9">
									<input type="text" name="base[share_title]" class="form-control" value="{$base['share_title']}" />
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-2 control-label">分享图片</label>
								<div class="col-sm-9">
									{php echo tpl_form_field_image('base[share_image]', $base['share_image']);}
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-2 control-label">分享描述</label>
								<div class="col-sm-9">
									<input type="text" name="base[share_desc]" class="form-control" value="{$base['share_desc']}" />
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="form-group">
				<label class="col-sm-2 control-label"></label>
				<div class="col-sm-9">
					<input type="submit" name="submit" value="提交" class="btn btn-primary min-width" />
					<input type="hidden" name="token" value="{$_W['token']}" />
				</div>
			</div>
		</form>
	</div>
</div>
<script>
	$(function() {
		window.optionchanged = false;
		$('#myTab a').click(function(e) {
			e.preventDefault(); //阻止a链接的跳转行为
			$(this).tab('show'); //显示当前选中的链接及关联的content
		})
	});
	//监听搜索框是否启用
	$("[name='base[search]']").change(function () {
		var val = $(this).val();
		if(val == 1){
            $(".form-group.search_float").hide();
            $(".form-group.search_bgColor").hide();
		}else{
            $(".form-group.search_float").show();
            if($("[name='base[search_float]']:checked").val() == 1){
                $(".form-group.search_bgColor").show();
			}else{
                $(".form-group.search_bgColor").hide();
			}
		}
    });
	//监听搜索框是否浮动
    $("[name='base[search_float]']").change(function () {
        var val = $(this).val();
        if(val == 1){
            $(".form-group.search_bgColor").show();
        }else{
            $(".form-group.search_bgColor").hide();
        }
    });
</script>
{php include wl_template('common/footer');}